{% extends '::base.html.twig' %}

{% block title %} Months {% endblock %}

{% block stylesheets %}
    {{ parent() }}
    <link href="{{ asset('bundles/acmebudgettracker/css/datepicker.css') }}" rel="stylesheet" type="text/css" />
{% endblock %}

{% block body %}
    
    {% include 'AcmeBudgetTrackerBundle::navbar.html.twig' with {'var':'Months'} %}

    <div class="little-spacer text-center"> 
        <h3>Months</h3>
        
        {% if app.session.hasFlash('notice') %}
            <div class="flash-notice text-error little-spacer lead">
                {{ app.session.flash('notice') }}
            </div>
        {% endif %}

        <form class="little-spacer" action="{{ path('create_month') }}" method="post" {{ form_enctype(form) }}>
            
            {{ form_widget(form) }}

            <button type="submit" class="btn">
                Submit
            </button>
             
        </form>
    
         <div class="big-spacer" id="container" style="width:100%; height:400px;"></div>

         {#   {% for m in all_months %}
            <p>{{m.name}} - {{m.budget}}</p>
        {% endfor %} #}
            
         <table class="table table-hover big-spacer">
             <tr>
                 <th>Month</th>
                 <th>Budget</th>
                 <th>Spent</th>
                 <th>Saved</th>
             </tr>
             
             <h4 class="big-spacer">All months</h4>
             
             {% if all_months_count > 0 %}
             {% for i in 0..all_months_count-1 %}
             <tr>
                     <td>{{ months[i] }}</td>
                     <td>{{ budget[i] }}</td>
                     <td class="text-error">{{ spent[i] }}</td>
                     {% if saved[i] >= 0 %}<td class="text-success">{{ saved[i] }}{% else %}<td class="text-error"><b>Overspent: {{ -saved[i] }}{% endif %}</b></td>
                     </tr>
             {% endfor %}
            {% endif %}
                
         </table>

           
            
          </div>   

    {%block javascript%}
       	<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
	<script src="http://code.highcharts.com/highcharts.js"></script>
            {# <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.js"></script> #}
        <script src="{{ asset('bundles/acmebudgettracker/js/bootstrap-datepicker.js') }}"></script>
        <script src="{{ asset('bundles/acmebudgettracker/js/month.js') }}"></script>
       {# <script src="http://code.highcharts.com/highcharts.js"></script>#}
    {%endblock%}

        
        {% if data != null %}
        <script>
            
        $('#container').highcharts({
        chart: {
            type: 'column'
        },
        title: {
            text: 'Budget for months'
        },
        xAxis: {
            categories: [{{ data|raw }}]
        },
        yAxis: {
            title: {
                text: 'Money'
            }
        },
        series: [{
            name: 'Spent',
            data: [{{ spent_joined }}],
            color: '#AA3333'
        }, {
            name: 'Budget',
            data: [{{ budget_joined }}],
            color: '#759E1A'
        }]
    }); 
            
         
            
    </script>
{% endif %}
{% endblock %}